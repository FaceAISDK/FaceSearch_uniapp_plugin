import { startFaceSearch, insertFaceSearchFeature, insertManyFeatures, addFaceSearchFeature, deleteFaceSearchFeature, ResultJSON } from "@/uni_modules/FaceAI-Search";
import { JSON_FACE_FEATURES_DATA } from "./testData.uts"; //模拟服务端测试数据批量插入
const __sfc__ = defineComponent({
    data() {
        return {
            faceID: 'Test',
            faceFeature: 'faceFeature is a string with lenth 1024',
            faceAIResult: 'faceAIResult'
        };
    },
    onLoad() {
    },
    methods: {
        startFaceSearchDemo: function () {
            const threshold = 0.88; // 阈值,只有人脸库中匹配到的人脸相似度大于此才有结果返回
            const oneTime = false; // 搜索页持续搜索接收结果 还是仅仅搜索一次返回一次结果
            const highRes = false; // true，高分辨率模式，远距离识别更佳，但会牺牲性能和速度
            const camId = 0; // 0，前置摄像头 1，后置摄像头。否则进入兼容模式（部分摄像头需适配）
            startFaceSearch(threshold, oneTime, highRes, camId, (jsonStr: string) => {
                // 这里会持续不断地收到json list Str回调，按照降序排列好了 
                console.log("收到搜索结果:", jsonStr, " at pages/index/index.uvue:58");
                this.faceAIResult = "【人脸搜索回调】\n" + jsonStr;
                // 2. 如果需要处理数据，建议包裹 try-catch 解析 JSON
                // try {
                //    const results = JSON.parse(jsonStr);
                //    if(results.length > 0) {
                //       // 可以在这里做业务逻辑，比如签到、开门等
                //    }
                // } catch(e) { console.error(e) }
            });
        },
        /**
        * 人脸搜索人脸特征录入，通过相机
        *
        */
        addFaceSearchFeatureDemo: function () {
            addFaceSearchFeature(this.faceID, 1, //1.快速模式2.精确模式
            (result: ResultJSON) => {
                //录入的人脸
                this.faceAIResult = JSON.stringify(result);
            });
        },
        /**
        * 删除人脸搜索人脸特征
        *
        */
        deleteFaceSearchFeatureDemo: function () {
            deleteFaceSearchFeature(this.faceID, (result: ResultJSON) => {
                this.faceAIResult = JSON.stringify(result);
            });
        },
        /**
        * 人脸搜索人脸特征更新同步
        *
        */
        insertFaceSearchFeatureDemo: function () {
            insertFaceSearchFeature(this.faceID, this.faceFeature, "tag", "group", (result: ResultJSON) => {
                //录入的人脸
                this.faceAIResult = JSON.stringify(result);
            });
        },
        /**
        * 批量操作人脸搜索人脸特征更新同步
        *
        */
        insertManyFaceFeatureSDemo: function () {
            insertManyFeatures(JSON_FACE_FEATURES_DATA, (result: ResultJSON) => {
                this.faceAIResult = JSON.stringify(result);
            });
        }
    }
});
export default __sfc__;
function GenPagesIndexIndexRender(this: InstanceType<typeof __sfc__>): any | null {
    const _ctx = this;
    const _cache = this.$.renderCache;
    return _cE("view", null, [
        _cE("button", _uM({
            class: "gray-button",
            onClick: _ctx.startFaceSearchDemo
        }), "1:N人脸搜索", 8 /* PROPS */, ["onClick"]),
        _cE("button", _uM({
            class: "gray-button",
            onClick: _ctx.addFaceSearchFeatureDemo
        }), "1:N人脸搜索录入人脸", 8 /* PROPS */, ["onClick"]),
        _cE("button", _uM({
            class: "gray-button",
            onClick: _ctx.deleteFaceSearchFeatureDemo
        }), "删除人脸搜索特征值", 8 /* PROPS */, ["onClick"]),
        _cE("button", _uM({
            class: "gray-button",
            onClick: _ctx.insertFaceSearchFeatureDemo
        }), "同步人脸搜索特征值", 8 /* PROPS */, ["onClick"]),
        _cE("button", _uM({
            class: "gray-button",
            onClick: _ctx.insertManyFaceFeatureSDemo
        }), "批量同步人脸搜索特征值", 8 /* PROPS */, ["onClick"]),
        _cE("view", _uM({ class: "result-box" }), [
            _cE("view", null, " Email: FaceAISDK.Service@gmail.com"),
            _cE("scroll-view", _uM({
                "scroll-y": "true",
                class: "scroll-view-box"
            }), [
                _cE("text", _uM({ class: "text-content" }), _tD(_ctx.faceAIResult), 1 /* TEXT */)
            ])
        ])
    ]);
}
const GenPagesIndexIndexStyles = [_uM([["result-box", _pS(_uM([["marginTop", "20rpx"], ["marginRight", "20rpx"], ["marginBottom", "20rpx"], ["marginLeft", "20rpx"]]))], ["scroll-view-box", _pS(_uM([["height", "400rpx"], ["borderTopWidth", 1], ["borderRightWidth", 1], ["borderBottomWidth", 1], ["borderLeftWidth", 1], ["borderTopStyle", "solid"], ["borderRightStyle", "solid"], ["borderBottomStyle", "solid"], ["borderLeftStyle", "solid"], ["borderTopColor", "#cccccc"], ["borderRightColor", "#cccccc"], ["borderBottomColor", "#cccccc"], ["borderLeftColor", "#cccccc"], ["borderTopLeftRadius", "10rpx"], ["borderTopRightRadius", "10rpx"], ["borderBottomRightRadius", "10rpx"], ["borderBottomLeftRadius", "10rpx"], ["backgroundColor", "#f8f8f8"], ["paddingTop", "15rpx"], ["paddingRight", "15rpx"], ["paddingBottom", "15rpx"], ["paddingLeft", "15rpx"], ["boxSizing", "border-box"]]))], ["text-content", _pS(_uM([["fontSize", "28rpx"], ["color", "#333333"], ["whiteSpace", "pre-wrap"]]))], ["gray-button", _pS(_uM([["backgroundColor", "#ffffff"], ["color", "#800080"], ["borderTopWidth", "medium"], ["borderRightWidth", "medium"], ["borderBottomWidth", "medium"], ["borderLeftWidth", "medium"], ["borderTopStyle", "none"], ["borderRightStyle", "none"], ["borderBottomStyle", "none"], ["borderLeftStyle", "none"], ["borderTopColor", "#000000"], ["borderRightColor", "#000000"], ["borderBottomColor", "#000000"], ["borderLeftColor", "#000000"]]))]])];
//# sourceMappingURL=index.uvue.map